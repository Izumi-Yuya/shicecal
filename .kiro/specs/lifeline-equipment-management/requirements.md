# Requirements Document

## Introduction

本機能は、既存のShise-Cal施設管理システムにライフライン・設備管理タブを追加します。施設詳細画面の既存タブ（基本、土地、建物）に「ライフライン設備」タブを追加し、5つのサブカテゴリ（電気、ガス、水道、エレベーター、空調・照明）で設備情報を管理します。

既存のUIパターン、デザインシステム、権限管理、コメント機能を完全に活用し、ユーザーにとって学習コストの低い一貫したエクスペリエンスを提供します。

## Requirements

### Requirement 1

**User Story:** 施設管理者として、既存の施設詳細画面にライフライン設備タブを追加して、統一されたインターフェースで設備情報を管理したい。これにより、既存の操作方法を変更することなく、新しい設備管理機能を利用できる。

#### Acceptance Criteria

1. WHEN 施設詳細画面にアクセスする場合 THEN システムは既存タブ（基本、土地、建物）に加えて「ライフライン設備」タブを表示する
2. WHEN ライフライン設備タブを選択する場合 THEN システムは既存の `nav nav-tabs` パターンを使用してサブタブナビゲーションを表示する
3. WHEN サブタブを表示する場合 THEN システムは5つのカテゴリタブを表示する：電気、ガス、水道、エレベーター、空調・照明
4. WHEN 各カテゴリタブを選択する場合 THEN システムは既存の `facility-info-card detail-card-improved` パターンを使用してカード群を表示する
5. WHEN カード情報を更新する場合 THEN システムは既存の権限管理システムを使用して編集権限をチェックする



### Requirement 2

**User Story:** 電気設備管理者として、電気設備の詳細情報を既存のカードパターンで管理したい。これにより、他の施設情報と同じ操作感で電気設備情報を入力・更新できる。

#### Acceptance Criteria

1. WHEN 電気タブを選択する場合 THEN システムは5つのカードを表示する：基本情報、PAS、キュービクル、非常用発電機、備考
2. WHEN 基本情報カードを表示する場合 THEN システムは `facility-detail-table` と `detail-row` パターンを使用して電気契約会社、保安管理業者、電気保守点検実施日、点検実施報告書PDFのフィールドを表示する
3. WHEN PAS、キュービクル、非常用発電機カードを表示する場合 THEN システムは有/無ドロップダウンと詳細情報入力フィールドを提供する
4. WHEN 複数設備エントリが必要な場合 THEN システムは動的な追加・削除機能を提供する（設備番号、メーカー、年式、更新年月日）
5. WHEN 各カードにコメント機能を実装する場合 THEN システムは既存のコメントシステムパターンを統合する





### Requirement 3

**User Story:** 設備管理者として、他のカテゴリ（ガス、水道、エレベーター、空調・照明）の基本構造を準備したい。これにより、将来的に各カテゴリの詳細仕様を定義する際の基盤を確保できる。

#### Acceptance Criteria

1. WHEN ガスタブを選択する場合 THEN システムは基本的なカード構造を表示する（カード内容は開発中）
2. WHEN 水道タブを選択する場合 THEN システムは基本的なカード構造を表示する（カード内容は開発中）
3. WHEN エレベータータブを選択する場合 THEN システムは基本的なカード構造を表示する（カード内容は開発中）
4. WHEN 空調・照明タブを選択する場合 THEN システムは基本的なカード構造を表示する（カード内容は開発中）
5. WHEN 各カテゴリのカードを表示する場合 THEN システムは既存の `facility-info-card detail-card-improved` パターンを使用する

**User Story:** システム開発者として、ライフライン設備管理機能を既存のShise-Calシステムと統一されたUIパターンで実装したい。これにより、ユーザーエクスペリエンスの一貫性を保ち、学習コストを削減できる。

#### Acceptance Criteria

1. WHEN ライフライン設備タブを実装する場合 THEN システムは既存の施設詳細画面の `nav nav-tabs` パターンに新しいタブとして統合する
2. WHEN 設備情報カードを表示する場合 THEN システムは `facility-info-card detail-card-improved` クラスを使用して統一されたカードデザインを適用する
3. WHEN カードヘッダーを作成する場合 THEN システムは既存パターンに従ってアイコン、タイトル、コメントボタンを配置する
4. WHEN 詳細情報を表示する場合 THEN システムは `facility-detail-table` と `detail-row` クラスを使用して統一されたテーブルレイアウトを適用する
5. WHEN 空のフィールドを表示する場合 THEN システムは `empty-field` クラスを使用して視覚的に区別する
6. WHEN コメント機能を実装する場合 THEN システムは既存のコメントシステムパターンを各設備カードに統合する
7. WHEN 権限管理を実装する場合 THEN システムは既存の `auth()->user()->isEditor()` パターンを使用して編集権限をチェックする
8. WHEN データ保存を実装する場合 THEN システムは既存のアクティビティログシステムと統合して変更履歴を記録する