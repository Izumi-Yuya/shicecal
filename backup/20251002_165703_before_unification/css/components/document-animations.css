/**
 * Document Management Animations and Transitions
 * ドキュメント管理アニメーション
 * 
 * Advanced animations and micro-interactions for the document management system
 * Includes loading states, transitions, and visual feedback
 * 
 * Browser Support: Chrome 90+, Firefox 88+, Safari 14+, Edge 90+
 * Last Updated: 2024-12-29
 */

/* ========================================
   Animation Variables - Scoped to Document Management
   ======================================== */
.document-management {
  /* Timing Functions */
  --ease-out-cubic: cubic-bezier(0.215, 0.61, 0.355, 1);
  --ease-in-out-cubic: cubic-bezier(0.645, 0.045, 0.355, 1);
  --ease-out-back: cubic-bezier(0.175, 0.885, 0.32, 1.275);
  --ease-in-out-back: cubic-bezier(0.68, -0.55, 0.265, 1.55);

  /* Animation Durations */
  --duration-fast: 0.15s;
  --duration-normal: 0.3s;
  --duration-slow: 0.5s;
  --duration-slower: 0.8s;
}

/* ========================================
   Page Load Animations
   ======================================== */

/* Document container fade in */
.document-management .document-management-container,
.document-management-container {
  animation: containerFadeIn 0.6s var(--ease-out-cubic);
}

@keyframes containerFadeIn {
  from {
    opacity: 0;
    transform: translateY(20px);
  }

  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Staggered item appearance */
.document-management .document-item-card,
.document-management .file-row,
.document-management .folder-row {
  animation: itemSlideIn 0.4s var(--ease-out-cubic) backwards;
}

.document-management .document-item-card:nth-child(1) {
  animation-delay: 0.1s;
}

.document-management .document-item-card:nth-child(2) {
  animation-delay: 0.15s;
}

.document-management .document-item-card:nth-child(3) {
  animation-delay: 0.2s;
}

.document-management .document-item-card:nth-child(4) {
  animation-delay: 0.25s;
}

.document-management .document-item-card:nth-child(5) {
  animation-delay: 0.3s;
}

.document-management .document-item-card:nth-child(6) {
  animation-delay: 0.35s;
}

.document-management .document-item-card:nth-child(n+7) {
  animation-delay: 0.4s;
}

.document-management .file-row:nth-child(1),
.document-management .folder-row:nth-child(1) {
  animation-delay: 0.05s;
}

.document-management .file-row:nth-child(2),
.document-management .folder-row:nth-child(2) {
  animation-delay: 0.1s;
}

.document-management .file-row:nth-child(3),
.document-management .folder-row:nth-child(3) {
  animation-delay: 0.15s;
}

.document-management .file-row:nth-child(4),
.document-management .folder-row:nth-child(4) {
  animation-delay: 0.2s;
}

.document-management .file-row:nth-child(5),
.document-management .folder-row:nth-child(5) {
  animation-delay: 0.25s;
}

.document-management .file-row:nth-child(n+6),
.document-management .folder-row:nth-child(n+6) {
  animation-delay: 0.3s;
}

@keyframes itemSlideIn {
  from {
    opacity: 0;
    transform: translateX(-20px);
  }

  to {
    opacity: 1;
    transform: translateX(0);
  }
}

/* ========================================
   Loading Animations
   ======================================== */

/* Enhanced spinner */
.document-management .document-loading .spinner-border {
  animation: spinnerGlow 2s ease-in-out infinite;
}

@keyframes spinnerGlow {

  0%,
  100% {
    box-shadow: 0 0 0 0 rgba(13, 110, 253, 0.4);
  }

  50% {
    box-shadow: 0 0 0 10px rgba(13, 110, 253, 0);
  }
}

/* Skeleton loading with shimmer effect */
.document-management .document-skeleton {
  background: linear-gradient(90deg,
      #f0f0f0 25%,
      #e0e0e0 50%,
      #f0f0f0 75%);
  background-size: 200% 100%;
  animation: shimmer 1.5s infinite;
}

@keyframes shimmer {
  0% {
    background-position: -200% 0;
  }

  100% {
    background-position: 200% 0;
  }
}

/* Pulsing dots for loading text */
.document-management .loading-dots::after {
  content: '';
  animation: loadingDots 1.5s infinite;
}

@keyframes loadingDots {

  0%,
  20% {
    content: '';
  }

  40% {
    content: '.';
  }

  60% {
    content: '..';
  }

  80%,
  100% {
    content: '...';
  }
}

/* ========================================
   Hover and Interaction Animations
   ======================================== */

/* Enhanced hover effects for cards */
.document-management .document-item-card {
  transition: all var(--duration-normal) var(--ease-out-cubic);
  position: relative;
  overflow: hidden;
}

.document-management .document-item-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg,
      transparent,
      rgba(255, 255, 255, 0.4),
      transparent);
  transition: left var(--duration-slow) var(--ease-out-cubic);
}

.document-management .document-item-card:hover::before {
  left: 100%;
}

/* Icon bounce on hover */
.document-management .document-item-card .item-icon {
  transition: transform var(--duration-normal) var(--ease-out-back);
}

.document-management .document-item-card:hover .item-icon {
  animation: iconBounce 0.6s var(--ease-out-back);
}

@keyframes iconBounce {
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(1.2) rotate(5deg);
  }

  100% {
    transform: scale(1.1) rotate(0deg);
  }
}

/* Table row slide effect */
.document-management .document-list-view .table tbody tr {
  transition: all var(--duration-normal) var(--ease-out-cubic);
  position: relative;
}

.document-management .document-list-view .table tbody tr::before {
  content: '';
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  width: 0;
  background: linear-gradient(90deg, var(--bs-primary), transparent);
  transition: width var(--duration-normal) var(--ease-out-cubic);
}

.document-management .document-list-view .table tbody tr:hover::before {
  width: 4px;
}

/* ========================================
   Modal and Dialog Animations
   ======================================== */

/* Modal entrance animation - scoped to document management */
.document-management .modal.fade .modal-dialog {
  transition: transform var(--duration-normal) var(--ease-out-cubic);
  transform: scale(0.8) translateY(-50px);
}

.document-management .modal.show .modal-dialog {
  transform: scale(1) translateY(0);
}

/* Modal backdrop animation - scoped to document management */
.document-management .modal-backdrop.fade {
  opacity: 0;
  transition: opacity var(--duration-normal) ease;
}

.document-management .modal-backdrop.show {
  opacity: 0.5;
}

/* バックドロップ問題の修正 - 最高優先度 */
body:not(.modal-open) .modal-backdrop {
  display: none !important;
  opacity: 0 !important;
  visibility: hidden !important;
}

/* モーダルが閉じた後の強制非表示 */
.modal:not(.show) {
  display: none !important;
  visibility: hidden !important;
}

/* Form field focus animations - scoped to document management */
.document-management .modal .form-control {
  transition: all var(--duration-fast) ease;
  position: relative;
}

.document-management .modal .form-control:focus {
  transform: scale(1.02);
  box-shadow: 0 0 0 0.2rem rgba(13, 110, 253, 0.25),
    0 4px 8px rgba(0, 0, 0, 0.1);
}

/* Button press animation - scoped to document management */
.document-management .modal .btn {
  transition: all var(--duration-fast) var(--ease-out-cubic);
}

.document-management .modal .btn:active {
  transform: scale(0.95);
}

/* ========================================
   Drag and Drop Animations
   ======================================== */

/* Drag start animation */
.draggable-item.drag-start {
  animation: dragStart var(--duration-normal) var(--ease-out-cubic);
}

@keyframes dragStart {
  0% {
    transform: scale(1) rotate(0deg);
  }

  50% {
    transform: scale(1.05) rotate(2deg);
  }

  100% {
    transform: scale(0.95) rotate(5deg);
  }
}

/* Drop zone activation */
.drop-zone.drag-over {
  animation: dropZoneActivate var(--duration-normal) var(--ease-out-cubic);
}

@keyframes dropZoneActivate {
  0% {
    transform: scale(1);
    border-color: transparent;
  }

  50% {
    transform: scale(1.02);
  }

  100% {
    transform: scale(1.01);
    border-color: var(--bs-primary);
  }
}

/* Drop success animation */
.drop-success {
  animation: dropSuccess var(--duration-slow) var(--ease-out-cubic);
}

@keyframes dropSuccess {
  0% {
    transform: scale(1);
    background-color: transparent;
  }

  50% {
    transform: scale(1.05);
    background-color: rgba(25, 135, 84, 0.1);
  }

  100% {
    transform: scale(1);
    background-color: transparent;
  }
}

/* ========================================
   Upload Progress Animations
   ======================================== */

/* Upload queue item entrance */
.queue-item {
  animation: queueItemEnter var(--duration-normal) var(--ease-out-cubic);
}

@keyframes queueItemEnter {
  from {
    opacity: 0;
    transform: translateX(-100%);
    max-height: 0;
  }

  to {
    opacity: 1;
    transform: translateX(0);
    max-height: 100px;
  }
}

/* Progress bar animation */
.progress-bar {
  transition: width var(--duration-normal) ease;
}

.progress-bar.animated {
  background-image: linear-gradient(45deg,
      rgba(255, 255, 255, 0.15) 25%,
      transparent 25%,
      transparent 50%,
      rgba(255, 255, 255, 0.15) 50%,
      rgba(255, 255, 255, 0.15) 75%,
      transparent 75%,
      transparent);
  background-size: 1rem 1rem;
  animation: progressStripes 1s linear infinite;
}

@keyframes progressStripes {
  0% {
    background-position: 1rem 0;
  }

  100% {
    background-position: 0 0;
  }
}

/* Upload completion celebration */
.upload-complete {
  animation: uploadCelebration var(--duration-slower) var(--ease-out-cubic);
}

@keyframes uploadCelebration {
  0% {
    transform: scale(1);
  }

  25% {
    transform: scale(1.1);
  }

  50% {
    transform: scale(1.05) rotate(2deg);
  }

  75% {
    transform: scale(1.02) rotate(-1deg);
  }

  100% {
    transform: scale(1) rotate(0deg);
  }
}

/* ========================================
   Error and Success Feedback
   ======================================== */

/* Error shake animation */
.error-shake {
  animation: errorShake var(--duration-slow) var(--ease-in-out-cubic);
}

@keyframes errorShake {

  0%,
  100% {
    transform: translateX(0);
  }

  10%,
  30%,
  50%,
  70%,
  90% {
    transform: translateX(-5px);
  }

  20%,
  40%,
  60%,
  80% {
    transform: translateX(5px);
  }
}

/* Success pulse animation */
.success-pulse {
  animation: successPulse var(--duration-slower) var(--ease-out-cubic);
}

@keyframes successPulse {
  0% {
    box-shadow: 0 0 0 0 rgba(25, 135, 84, 0.7);
    transform: scale(1);
  }

  70% {
    box-shadow: 0 0 0 10px rgba(25, 135, 84, 0);
    transform: scale(1.05);
  }

  100% {
    box-shadow: 0 0 0 0 rgba(25, 135, 84, 0);
    transform: scale(1);
  }
}

/* Warning wiggle animation */
.warning-wiggle {
  animation: warningWiggle var(--duration-slow) var(--ease-in-out-cubic);
}

@keyframes warningWiggle {

  0%,
  100% {
    transform: rotate(0deg);
  }

  25% {
    transform: rotate(1deg);
  }

  75% {
    transform: rotate(-1deg);
  }
}

/* ========================================
   Notification Animations
   ======================================== */

/* Toast notification slide in */
.toast-notification {
  animation: toastSlideIn var(--duration-normal) var(--ease-out-cubic);
}

@keyframes toastSlideIn {
  from {
    opacity: 0;
    transform: translateX(100%);
  }

  to {
    opacity: 1;
    transform: translateX(0);
  }
}

/* Toast notification slide out */
.toast-notification.hiding {
  animation: toastSlideOut var(--duration-normal) var(--ease-in-out-cubic);
}

@keyframes toastSlideOut {
  from {
    opacity: 1;
    transform: translateX(0);
  }

  to {
    opacity: 0;
    transform: translateX(100%);
  }
}

/* ========================================
   Search and Filter Animations
   ======================================== */

/* Search input focus animation */
.document-search-input .form-control {
  transition: all var(--duration-normal) var(--ease-out-cubic);
}

.document-search-input .form-control:focus {
  transform: scale(1.02);
  box-shadow: 0 0 0 0.2rem rgba(13, 110, 253, 0.25),
    0 4px 12px rgba(13, 110, 253, 0.15);
}

/* Filter results animation */
.filter-results-enter {
  animation: filterResultsEnter var(--duration-normal) var(--ease-out-cubic);
}

@keyframes filterResultsEnter {
  from {
    opacity: 0;
    transform: translateY(10px);
  }

  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* No results animation */
.no-results {
  animation: noResultsBounce var(--duration-slower) var(--ease-out-back);
}

@keyframes noResultsBounce {
  0% {
    opacity: 0;
    transform: scale(0.8);
  }

  50% {
    transform: scale(1.1);
  }

  100% {
    opacity: 1;
    transform: scale(1);
  }
}

/* ========================================
   Breadcrumb Animations
   ======================================== */

/* Breadcrumb item entrance */
.breadcrumb-item {
  animation: breadcrumbEnter var(--duration-normal) var(--ease-out-cubic);
}

@keyframes breadcrumbEnter {
  from {
    opacity: 0;
    transform: translateX(-10px);
  }

  to {
    opacity: 1;
    transform: translateX(0);
  }
}

/* Breadcrumb separator animation */
.breadcrumb-item+.breadcrumb-item::before {
  transition: all var(--duration-fast) ease;
}

.breadcrumb-item:hover+.breadcrumb-item::before {
  color: var(--bs-primary);
  transform: scale(1.2);
}

/* ========================================
   Context Menu Animations
   ======================================== */

/* Context menu entrance */
.context-menu {
  animation: contextMenuEnter var(--duration-fast) var(--ease-out-cubic);
  transform-origin: top left;
}

@keyframes contextMenuEnter {
  from {
    opacity: 0;
    transform: scale(0.8) translateY(-10px);
  }

  to {
    opacity: 1;
    transform: scale(1) translateY(0);
  }
}

/* Context menu item hover */
.context-menu-item {
  transition: all var(--duration-fast) var(--ease-out-cubic);
  position: relative;
  overflow: hidden;
}

.context-menu-item::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(13, 110, 253, 0.1), transparent);
  transition: left var(--duration-normal) var(--ease-out-cubic);
}

.context-menu-item:hover::before {
  left: 100%;
}

/* ========================================
   Responsive Animation Adjustments
   ======================================== */

/* Reduce animations on mobile for performance */
@media (max-width: 768px) {

  .document-item-card::before,
  .context-menu-item::before {
    display: none;
  }

  .document-item-card:hover .item-icon {
    animation: none;
    transform: scale(1.05);
  }

  .document-list-view .table tbody tr::before {
    display: none;
  }
}

/* ========================================
   Accessibility Considerations
   ======================================== */

/* Respect reduced motion preferences */
@media (prefers-reduced-motion: reduce) {

  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }

  .document-skeleton {
    background: #f0f0f0;
  }

  .progress-bar.animated {
    background-image: none;
  }
}

/* High contrast mode adjustments */
@media (prefers-contrast: high) {

  .document-item-card::before,
  .context-menu-item::before {
    display: none;
  }

  .progress-bar.animated {
    background-image: none;
  }
}

/* ========================================
   Performance Optimizations
   ======================================== */

/* Use transform and opacity for better performance */
.document-item-card,
.file-row,
.folder-row {
  will-change: transform, opacity;
}

.document-item-card:hover,
.file-row:hover,
.folder-row:hover {
  will-change: auto;
}

/* GPU acceleration for smooth animations */
.document-item-card .item-icon,
.progress-bar,
.modal-dialog {
  transform: translateZ(0);
  backface-visibility: hidden;
}

/* ========================================
   Print Styles
   ======================================== */
@media print {
  * {
    animation: none !important;
    transition: none !important;
  }

  .document-item-card::before,
  .context-menu-item::before {
    display: none !important;
  }
}